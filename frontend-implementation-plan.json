{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Implement full page light/dark theme toggle with sun/moon icon",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Implement a full page light/dark theme toggle using the existing sun/moon icon in the header. Apply the dark class to the root HTML element to enable Tailwind dark: variants globally, affecting all backgrounds, text, cards, headers, navigation, and UI components. Persist the user's theme preference to localStorage and restore it on page reload.",
      "acceptanceCriteria": [
        "Clicking the sun icon switches the entire page to dark mode — all backgrounds, text, cards, headers, and UI elements adopt the dark color scheme",
        "Clicking the moon icon switches the entire page back to light mode — all elements restore the bright/light appearance",
        "The dark class (or equivalent) is applied to the root HTML element or body so Tailwind dark: variants take effect globally",
        "All existing pages (Dashboard, Certifications, Study Materials, Flashcards, Practice Test, Q&A Practice, Study Mode) correctly reflect the active theme",
        "The selected theme is persisted in localStorage and restored on page reload",
        "The sun/moon icon correctly reflects the current theme state (sun shown in dark mode, moon shown in light mode, or vice versa consistently)"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/Layout.tsx",
          "operation": "modify",
          "description": "Update the existing theme toggle logic to apply the 'dark' class to the document root element (document.documentElement) instead of only toggling icon state. On theme change, call document.documentElement.classList.toggle('dark', isDark) to enable Tailwind's dark mode globally. Ensure the theme state is read from localStorage on mount ('theme' key) and persisted on every toggle. Update the sun/moon icon rendering to correctly reflect the current theme (show sun in dark mode, moon in light mode, or vice versa based on design preference)."
        },
        {
          "path": "frontend/src/index.css",
          "operation": "modify",
          "description": "Ensure that all existing OKLCH-based CSS custom properties have corresponding dark mode variants defined under a .dark selector or :root.dark scope. Verify that variables like --background, --foreground, --card, --border, --primary, --secondary, etc., have dark mode overrides that apply when the 'dark' class is present on the root element. Do not add new color tokens; only ensure the existing tokens are correctly scoped for both light and dark themes."
        },
        {
          "path": "frontend/tailwind.config.js",
          "operation": "modify",
          "description": "Verify that darkMode is set to 'class' (not 'media') so that Tailwind's dark: variants are activated by the presence of the 'dark' class on the root element. Ensure all custom color tokens reference CSS variables that have dark mode overrides in index.css. No new theme colors should be added; this is a verification-only step."
        },
        {
          "path": "frontend/src/pages/Dashboard.tsx",
          "operation": "modify",
          "description": "Add Tailwind dark: variant classes to all backgrounds, text, cards, and UI elements to ensure they respond to the global dark mode toggle. For example, apply dark:bg-gray-900, dark:text-white, dark:border-gray-700 to container divs, cards, and text elements. Ensure certification cards and score displays adopt the dark theme when the 'dark' class is present on the root element."
        },
        {
          "path": "frontend/src/pages/CertificationSelector.tsx",
          "operation": "modify",
          "description": "Add Tailwind dark: variant classes to all certification card backgrounds, borders, text elements, and badges. Ensure that when the 'dark' class is active on the root element, all cards display with dark backgrounds, light text, and appropriate border colors (e.g., dark:bg-gray-800, dark:text-white, dark:border-gray-600)."
        },
        {
          "path": "frontend/src/pages/StudyMaterials.tsx",
          "operation": "modify",
          "description": "Add Tailwind dark: variant classes to the study materials grid, card backgrounds, progress indicators, and text elements. Ensure reading progress bars and card overlays adopt dark-themed colors when the 'dark' class is present (e.g., dark:bg-gray-800, dark:text-gray-100)."
        },
        {
          "path": "frontend/src/pages/Flashcards.tsx",
          "operation": "modify",
          "description": "Add Tailwind dark: variant classes to all flashcard setup, study, and review phase UI elements. Apply dark mode styles to buttons, input fields, card containers, and result summaries (e.g., dark:bg-gray-900, dark:text-white, dark:border-gray-700)."
        },
        {
          "path": "frontend/src/pages/PracticeTest.tsx",
          "operation": "modify",
          "description": "Add Tailwind dark: variant classes to the practice test interface, including the timer, question cards, answer options, and results review screen. Ensure all interactive elements (buttons, radio buttons, submit button) respond to the global dark mode (e.g., dark:bg-gray-800, dark:text-white, dark:hover:bg-gray-700)."
        },
        {
          "path": "frontend/src/pages/QAPractice.tsx",
          "operation": "modify",
          "description": "Add Tailwind dark: variant classes to the Q&A practice quiz interface, including domain filters, question cards, feedback displays, and the final review summary. Ensure all text, backgrounds, and borders adopt dark mode colors when the 'dark' class is active (e.g., dark:bg-gray-900, dark:text-gray-100, dark:border-gray-600)."
        },
        {
          "path": "frontend/src/pages/StudyMode.tsx",
          "operation": "modify",
          "description": "Add Tailwind dark: variant classes to the chat-based study mode interface, including message bubbles, input fields, voice control buttons, and the domain selector. Ensure the chat container, messages, and controls adopt dark backgrounds and light text when the 'dark' class is present (e.g., dark:bg-gray-800, dark:text-white)."
        },
        {
          "path": "frontend/src/components/FlashcardDeck.tsx",
          "operation": "modify",
          "description": "Add Tailwind dark: variant classes to the flashcard front/back display and action buttons (correct/incorrect). Ensure the flip animation container and button states respond to the global dark mode (e.g., dark:bg-gray-800, dark:text-white, dark:border-gray-600)."
        },
        {
          "path": "frontend/src/components/PDFViewer.tsx",
          "operation": "modify",
          "description": "Add Tailwind dark: variant classes to the modal PDF/HTML viewer, including the modal backdrop, close button, progress indicator, and the iframe/content container. Ensure all overlays and controls adopt dark mode styling when the 'dark' class is active (e.g., dark:bg-gray-900, dark:border-gray-700)."
        },
        {
          "path": "frontend/src/components/VoiceControls.tsx",
          "operation": "modify",
          "description": "Add Tailwind dark: variant classes to the voice controls UI, including the mic toggle button, speaking/listening status indicators, and the collapsible settings panel. Ensure all buttons, sliders, and labels respond to the global dark mode (e.g., dark:bg-gray-800, dark:text-white, dark:border-gray-600)."
        }
      ]
    }
  ]
}